promtail:
  fullnameOverride: promtail
  serviceMonitor:
    enabled: true
  config:
    #serverPort: 3100
    lokiAddress: http://loki.loki.svc:3100/loki/api/v1/push
    snippets:
      extraScrapeConfigs: |
        # Add an additional scrape config for syslog
        - job_name: journal
          journal:
            path: /var/log/journal
            max_age: 12h
            labels:
              job: systemd-journal
          relabel_configs:
            - source_labels:
                - '__journal__systemd_unit'
              target_label: 'unit'
            - source_labels:
                - '__journal__hostname'
              target_label: 'hostname'

  # Mount journal directory into promtail pods
  extraVolumes:
    - name: journal
      hostPath:
        path: /var/log/journal

  extraVolumeMounts:
    - name: journal
      mountPath: /var/log/journal
      readOnly: true

  resources:
    requests:
      cpu: 400m
      memory: 256Mi
    limits:
      cpu: 1000m
      memory: 512Mi
